<!DOCTYPE html>
<html lang="pt-BR">

<head>
  <meta charset="UTF-8">
  <title>Gerador de Template GitLab</title>
  <link rel="icon" type="image/png"
    href="https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/25.png">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@11.9.0/styles/github-dark.min.css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/github-markdown-css/github-markdown.min.css">
  <link rel="stylesheet" href="./css/home.css">
</head>

<body class="bg-dark text-light">
  <div class="container py-3 mb-0">
    <div class="card mx-auto shadow" style="max-width: 800px; border-radius: 12px;">
      <div class="card-body bg-white text-dark p-4 rounded">
        <div class="container py-3">
          <h2 id="tituloPrincipal" class="mb-4"><i class="fas fa-tools"></i> Gerador de Template GitLab</h2>

          <div class="d-flex justify-content-between align-items-center gap-3">
            <div>
              <button class="btn btn-outline-secondary btn-sm me-2 my-2" data-bs-toggle="modal" data-bs-target="#modalImportar">
                <i class="fas fa-download"></i> Importar template
              </button>
            
              <button class="btn btn-outline-secondary btn-sm" data-bs-toggle="modal" data-bs-target="#modalExportar">
                <i class="fas fa-upload me-1"></i> Exportar template
              </button>
            </div>

            <button class="btn btn-outline-secondary btn-sm" data-bs-toggle="modal" data-bs-target="#modalAjuda">
              <i class="fas fa-info-circle"></i>
            </button>
          </div>

          <div class="modal fade" id="modalAjuda" tabindex="-1" aria-labelledby="modalAjudaLabel" aria-hidden="true">
            <div class="modal-dialog modal-lg">
              <div class="modal-content text-dark">
                <div class="modal-header">
                  <h5 class="modal-title" id="modalAjudaLabel"><i class="fas fa-info-circle me-2"></i>Ajuda e Recursos
                  </h5>
                  <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Fechar"></button>
                </div>
                <div class="modal-body">
                  <ul class="list-group list-group-flush">
                    <li class="list-group-item">
                      <i class="fas fa-shoe-prints text-primary me-2"></i>
                      <strong>Passos:</strong> Pressione <kbd>Enter</kbd> para adicionar. Digite <code>&gt;</code> para
                      gerar <span class="text-success">→</span>.
                      Ao digitar <code>(</code>, aparecem atalhos como <code>Categoria (PL020)</code>, que viram
                      <strong>negrito</strong> no markdown.
                    </li>
                    <li class="list-group-item">
                      <i class="fas fa-bolt text-warning me-2"></i>
                      <strong>Atalhos:</strong> Digite <code>/</code> em um campo de passo para abrir <em>blocos
                        inteligentes</em> com múltiplos passos.
                    </li>
                    <li class="list-group-item">
                      <i class="fas fa-layer-group text-info me-2"></i>
                      <strong>Preparativos:</strong> Grupos extras de passos com título. Também aceitam blocos e atalhos
                      com <code>(</code>.
                    </li>
                    <li class="list-group-item">
                      <i class="fas fa-code text-danger me-2"></i>
                      <strong>Markdown:</strong> Estrutura otimizada para reuso. Use <kbd>Alt</kbd> + <kbd>Enter</kbd>
                      para gerar instantaneamente.
                    </li>
                    <li class="list-group-item">
                      <i class="fas fa-file-export text-success me-2"></i>
                      <strong>Importar/Exportar:</strong> Salve ou compartilhe com arquivos <code>.json</code>.
                    </li>
                    <li class="list-group-item">
                      <i class="fas fa-folder-open text-secondary me-2"></i>
                      <strong>Personalização:</strong> Você pode adicionar novos <code>shortcuts</code> e
                      <code>blocos de passos</code> diretamente no arquivo <code>shortcuts.js</code>, dentro da pasta do
                      projeto.
                    </li>
                  </ul>
                </div>
              </div>
            </div>
          </div>

          <div class="modal fade" id="modalImportar" tabindex="-1" aria-labelledby="modalImportarLabel"
            aria-hidden="true">
            <div class="modal-dialog">
              <div class="modal-content text-dark">
                <div class="modal-header">
                  <h5 class="modal-title" id="modalImportarLabel">
                    <i class="fas fa-file-import me-2"></i>Importar Template GitLab
                  </h5>
                  <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Fechar"></button>
                </div>
                <div class="modal-body">
                  <label for="arquivoJson" class="form-label">Selecionar arquivo .json</label>
                  <input type="file" id="arquivoJson" accept=".json" class="form-control">
                </div>
                <div class="modal-footer">
                  <button class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</button>
                  <button class="btn btn-success" onclick="importarArquivoJson()">Importar agora</button>
                </div>
              </div>
            </div>
          </div>

          <div class="mb-3">
            <label class="form-label">
              <i class="fas fa-tag"></i>Tarefa:
            </label>
            <input type="text" class="form-control" id="nomeTarefa" placeholder="Ex: ACT-1111">
          </div>

          <div class="mb-3">
            <label class="form-label">
              <i class="fas fa-circle"></i>
              Escopo:
            </label>
            <input type="text" class="form-control" id="escopo" placeholder="Descrever o que foi feito">
          </div>

          <hr class="section-divider">

          <div class="mb-1 d-flex align-items-center">
            <i class="fas fa-toolbox me-2 text-secondary"></i>
            <h5 class="mb-0 fw-bold">Preparativos</h5>
          </div>

          <div class="mb-3">
            <button class="btn btn-outline-secondary btn-sm" onclick="adicionarPreparativo()">
              <i class="fas fa-plus"></i> Adicionar Preparativo
            </button>
            <button class="btn btn-outline-secondary btn-sm" data-bs-toggle="modal" data-bs-target="#modalCodigo">
              <i class="fas fa-code"></i> Adicionar Bloco de Código
            </button>
          </div>

          <div id="containerBlocosCodigo" class="mt-3"></div>
          <div id="containerPreparativos"></div>

          <hr class="section-divider">

          <div class="mb-2">
            <label class="form-label" for="novoPasso">
              <i class="fas fa-shoe-prints"></i> Passo de teste:
            </label>
            <div class="input-group">
              <input type="text" id="novoPasso" class="form-control" placeholder="Digite um passo e pressione Enter">
              <button class="btn btn-outline-success" type="button" onclick="adicionarPasso()">
                <i class="fas fa-plus"></i>
              </button>
              <div id="sugestoesPasso" class="list-group position-absolute z-3 sug-autocomplete" style="display: none;">
              </div>
            </div>
          </div>

          <div class="modal fade" id="modalBlocos" tabindex="-1" aria-labelledby="modalBlocosLabel" aria-hidden="true">
            <div class="modal-dialog">
              <div class="modal-content text-dark">
                <div class="modal-header">
                  <h5 class="modal-title" id="modalBlocosLabel">Inserir passos pré-definidos</h5>
                  <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Fechar"></button>
                </div>
                <div class="modal-body">
                  <div id="modalBlocosBody" class="list-group"></div>
                </div>
              </div>
            </div>
          </div>

          <ul class="list-group mb-4" id="listaPassos"></ul>

          <hr class="section-divider">

          <div class="mb-3">
            <label class="form-label"><i class="fas fa-exclamation-triangle"></i> Critérios de Aceitação:</label>
            <div class="input-group mb-2">
              <input type="text" id="novoCriterio" class="form-control"
                placeholder="Descreva o critério e pressione Enter">
              <button class="btn btn-outline-secondary" type="button" onclick="adicionarCriterio()">
                <i class="fas fa-plus"></i>
              </button>
            </div>
            <ul class="list-group" id="listaCriterios"></ul>
          </div>

          <hr class="section-divider">

          <div class="mb-4">
            <label class="form-label">
              <i class="fas fa-flag"></i> Impacto:
            </label>
            <textarea class="form-control" id="impacto" rows="3" placeholder="1. Impacta tal módulo..."></textarea>
          </div>

          <hr class="section-divider">

          <div class="mb-3">
            <label class="form-label"><i class="fas fa-globe"></i> Navegadores testados:</label>
            <div class="form-check">
              <input class="form-check-input" type="checkbox" id="chrome">
              <label class="form-check-label" for="chrome">Google Chrome</label>
            </div>
            <div class="form-check">
              <input class="form-check-input" type="checkbox" id="edge">
              <label class="form-check-label" for="edge">Microsoft Edge</label>
            </div>
          </div>

          <hr class="section-divider">

          <div class="mb-4">
            <label class="form-label"><i class="fas fa-save"></i> Bancos de dados testados:</label>
            <div class="form-check">
              <input class="form-check-input" type="checkbox" id="sqlserver">
              <label class="form-check-label" for="sqlserver">SQL Server (ISO 8859-1)</label>
            </div>
            <div class="form-check">
              <input class="form-check-input" type="checkbox" id="oracleIso">
              <label class="form-check-label" for="oracleIso">Oracle (ISO 8859-1)</label>
            </div>
            <div class="form-check">
              <input class="form-check-input" type="checkbox" id="postgres">
              <label class="form-check-label" for="postgres">PostGreSQL (UTF8)</label>
            </div>
            <div class="form-check">
              <input class="form-check-input" type="checkbox" id="oracleUtf">
              <label class="form-check-label" for="oracleUtf">Oracle (UTF8)</label>
            </div>
          </div>

          <hr class="section-divider">

          <div
            class="d-flex justify-content-between align-items-center flex-wrap bg-light p-3 rounded shadow-sm toolbar-custom">
            <button class="btn btn-secondary-light btn-sm" onclick="gerar()">
              <i class="fa-solid fa-gears me-1"></i> Gerar Markdown
              <small class="text-white-50 ms-1">(Alt + Enter)</small>
            </button>

            <button class="btn btn-delete-light btn-sm" onclick="limparDraft()">
              <i class="fas fa-broom me-1"></i> Limpar rascunho
            </button>
          </div>

          <div class="d-flex justify-content-between align-items-center">
            <h5>
              <i class="fas fa-clipboard"></i>
              Resultado:
            </h5>
            <button id="copy_btn" disabled="true" class="btn btn-outline-secondary btn-sm my-2"
              onclick="copiarResultado()">
              <i class="fas fa-copy"></i> Copiar
            </button>
          </div>
          <textarea class="form-control" id="resultado" rows="25" readonly></textarea>
        </div>

      </div>
    </div>
  </div>

  <div class="modal fade" id="modalExportar" tabindex="-1" aria-labelledby="modalExportarLabel" aria-hidden="true">
    <div class="modal-dialog">
      <div class="modal-content text-dark">
        <div class="modal-header">
          <h5 class="modal-title" id="modalExportarLabel">
            <i class="fas fa-file-export me-2"></i>Exportar Template GitLab
          </h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Fechar"></button>
        </div>
        <div class="modal-body">
          <label for="nomeExportar" class="form-label">Nome do arquivo</label>
          <input type="text" id="nomeExportar" class="form-control" placeholder="ex: plano-teste-2024">
        </div>
        <div class="modal-footer">
          <button class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</button>
          <button class="btn btn-success" onclick="exportarJson()">Exportar agora</button>
        </div>
      </div>
    </div>
  </div>

  <div class="modal fade text-dark" id="modalCriterios" tabindex="-1" aria-labelledby="modalCriteriosLabel"
    aria-hidden="true">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="modalCriteriosLabel">Gerenciar passo de teste</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Fechar"></button>
        </div>
        <div class="modal-body">
          <div class="mb-3">
            <label for="editarTextoPasso" class="form-label">
              <i class="fa-solid fa-pencil"></i> Editar passo
            </label>
            <input type="text" id="editarTextoPasso" class="form-control">
          </div>
          <label for="editarTextoPasso" class="form-label">
            <i class="fa-solid fa-link"></i> Vincular critério de aceitação
          </label>

          <div id="listaCriteriosModal"></div>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</button>
          <button type="button" class="btn btn-primary" onclick="confirmarVinculoCriterios()">Salvar</button>
        </div>
      </div>
    </div>
  </div>

  <div class="modal fade" id="modalCodigo" tabindex="-1">
    <div class="modal-dialog">
      <div class="modal-content text-dark">
        <div class="modal-header">
          <h5 class="modal-title"><i class="fas fa-code me-2"></i> Inserir Código</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
        </div>
        <div class="modal-body">
          <label for="tituloCodigo" class="form-label">Título do bloco</label>
          <input type="text" id="tituloCodigo" class="form-control mb-3" placeholder="Ex: Script de limpeza de cache">
          <label for="linguagemCodigo" class="form-label">Linguagem</label>
          <select id="linguagemCodigo" class="form-select mb-3">
            <option value="php">PHP</option>
            <option value="javascript">JavaScript</option>
            <option value="html">HTML</option>
            <option value="sql">SQL</option>
            <option value="java">Java</option>
          </select>
  
          <label for="blocoCodigo" class="form-label">Código</label>
          <textarea id="blocoCodigo" class="form-control" rows="8" placeholder="Cole ou digite seu código aqui..."></textarea>
        </div>
        <div class="modal-footer">
          <button class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</button>
          <button class="btn btn-success" onclick="inserirBlocoDeCodigo()">Inserir</button>
        </div>
      </div>
    </div>
  </div>  

  <button class="btn btn-primary shadow preview-fab" onclick="abrirPreviewMarkdown()">
    <i class="fas fa-eye"></i>
  </button>

  <div class="modal fade" id="modalPreview" tabindex="-1">
    <div class="modal-dialog modal-xl modal-dialog-scrollable">
      <div class="modal-content text-dark">
        <div class="modal-header d-flex justify-content-between align-items-center">
          <h5 class="modal-title mb-0">📄 Pré-visualização do Markdown</h5>
          <div class="d-flex gap-2">
            <button class="btn btn-outline-dark btn-sm" onclick="exportarPDF()">
              <i class="fas fa-file-pdf"></i> Exportar PDF
            </button>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Fechar"></button>
          </div>
        </div>
        <div class="modal-body">
          <div id="previewMarkdownContent" class="markdown-body px-2"></div>
        </div>
      </div>
    </div>
  </div>   

  <footer class="text-center mt-1 text-white" style="font-size: 0.9rem;">
    Desenvolvido por <strong>Lindomar Lima - ACT</strong>
  </footer>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/marked/15.0.7/marked.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.11.1/highlight.min.js"></script>

  <script src="./shortcuts.js"></script>
  <script src="./js/index.js"></script>


  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>

</body>

</html>